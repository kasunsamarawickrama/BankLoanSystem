@model BankLoanSystem.Models.TitleStatus
@{
    Layout = null;
    ViewBag.Title = "Title Status Update";
    
}

<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>Title Status Update</title>

    <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
    @*<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
        <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>*@

    <link href="~/Content/bootstrap.min.css" rel="stylesheet" />
    <script src="~/scripts/jquery-1.10.2.min.js"></script>
    <script src="~/scripts/bootstrap.min.js"></script>
    <link href="~/Content/commonActions.css" rel="stylesheet" />

</head>
<body>

    <div class="container" id="container">




        @{
            Html.RenderAction("LoanInfo", "Unit", new { title = @ViewBag.Title, msg = @ViewBag.Msg });
        }



        <div class="details-container">

            @*<div class="right-panel">
                                @{
                //Html.RenderAction("LoanPaymentDetails", "Unit");
                                }

                            </div>*@


            <div class="body-content" style="float:right;margin-bottom:15px;width:100%;height:auto">
              
                <div class="info-bar">

                    <div class="form-group row" style="margin-bottom: 0px;">
                        <label for="" class="col-sm-6 form-control-label">Enter the last 6 characters of the VIN/HIN/Serial Number for the unit you would like to update the title status of.</label>


                        <div class="col-md-2">
                            @Html.EditorFor(model=>model.IdentificationNumberSearch,new { htmlAttributes = new { @class = "form-control",@id = "identificationNumberSearch",@maxlength =6 } })
                            @Html.ValidationMessageFor(model => model.IdentificationNumberSearch, "", new { @class = "text-danger" })
                            <span class="text-danger"></span>
                        </div>
                         <button type="button" class="btn btn-info" id="btnDisplay">Display</button>
                    </div>



                </div>

                <div class="info-bar" id="searchGrid1" style="margin-top:15px">
                  
                </div>

                <div class="info-bar search-panel" style="margin-top:15px;">

                    <div class="form-inline" style="margin-left:25px;">
                        <div class="form-group">
                            <label for="">VIN/HIN/Serial</label>
                            @Html.EditorFor(model => model.TitleDetails.IdentificationNumber, new { htmlAttributes = new { @class = "form-control", @id = "identificationNumber",@disabled = "disabled" } })
                            @Html.ValidationMessageFor(model => model.TitleDetails.IdentificationNumber, "", new { @class = "text-danger" })
                        </div>

                        <div class="form-group" style="margin-left:20px;">
                            <label for="">Year</label>
                            @Html.EditorFor(model => model.TitleDetails.Year, new { htmlAttributes = new { @class = "form-control", @id = "unitYear", @style = "width:90px", @disabled = "disabled" } })
                            @Html.ValidationMessageFor(model => model.TitleDetails.Year, "", new { @class = "text-danger" })
                        </div>

                        <div class="form-group" style="margin-left:20px;">
                            <label for="">Make</label>
                            @Html.EditorFor(model => model.TitleDetails.Make, new { htmlAttributes = new { @class = "form-control", @id = "unitMake", @style = "width:90px", @disabled = "disabled" } })
                            @Html.ValidationMessageFor(model => model.TitleDetails.Make, "", new { @class = "text-danger" })
                        </div>

                        <div class="form-group" style="margin-left:20px;">
                            <label for="">Model</label>
                            @Html.EditorFor(model => model.TitleDetails.Model, new { htmlAttributes = new { @class = "form-control", @id = "unitModel", @style = "width:100px", @disabled = "disabled" } })
                            @Html.ValidationMessageFor(model => model.TitleDetails.Model, "", new { @class = "text-danger" })
                        </div>

                        <div class="form-group" style="margin-left:20px;">
                            <label for="">Current Title Status</label>
                            @Html.EditorFor(model => model.TitleDetails.CurrentTitleStatus, new { htmlAttributes = new { @class = "form-control", @id = "titleStatus", @style = "width:150px", @disabled = "disabled" } })
                            @Html.ValidationMessageFor(model => model.TitleDetails.CurrentTitleStatus, "", new { @class = "text-danger" })
                        </div>

                        <div class="form-group row" style="margin-top:25px">
                            <label for="" class="col-sm-9 form-control-label">Select the status you wish to update the title to: </label>


                            <div class="col-md-8" style="margin-left:200px">
                                <label class="radio-inline">
                                    <input type="radio" name="inlineRadioOptions" id="notReceived" value="0"> Not Recieved

                                </label>
                                <label class="radio-inline">
                                    <input type="radio" name="inlineRadioOptions" id="received" value="1"> Recieved
                                </label>
                                @if (ViewBag.CompanyType == 1)
                                {
                                    <label class="radio-inline">
                                        <input type="radio" name="inlineRadioOptions" id="returnDealer" value="2"> Returned to Dealer
                                    </label>
                                }
                                else if(ViewBag.CompanyType == 2)
                                {
                                    <label class="radio-inline">
                                        <input type="radio" name="inlineRadioOptions" id="sentBank" value="3"> Sent to Bank
                                    </label>
                                }
                                
                            </div>

                        </div>

                      
                        <div class="form-group" style="margin-top:25px;">
                            <button type="button" class="btn btn-default" style="margin-right:25px;float:right;">Cancel</button>

                            <button type="submit" class="btn btn-info" id="btnUpdate"style="margin-right:25px;float:right;width:100px">Update</button>

                        </div>
                    </div>



                </div>


            </div>

        </div>


        <div class="link-bar" style="margin-bottom:15px;">


            @{
                Html.RenderAction("GetLinkBar", "Unit");
            }


        </div>


    </div>
    <script>
        $(document).ready(function () {
            $('#searchGrid1').hide();
        });
        function SetTextBoxValues_2(vinNum, yr, make1, model1, tit)
        {
            //var model = @Html.Raw(Json.Encode(Model));
            //alert(model.TitleDetails.Year);
            $('#searchGrid1').hide();
            $('#identificationNumber').val(vinNum);
            $('#unitYear').val(yr);
            $('#unitMake').val(make1);
            $('#unitModel').val(model1);
            $('#titleStatus').val(tit);
        };
        $('#btnDisplay').click(function ()
        {
            var para1 = $('#identificationNumberSearch').val();
            $.ajax({
                url: '/UnitTitle/SearchTitleStatus',
                type: 'POST',
                contentType: 'application/json;',
                data: JSON.stringify({ identificationNumber: para1}),
                success: function (View) {
                    $('#searchGrid1').html(View);
                    //$('#searchGrid1').show();
                },
                error: function (reponse) {
                    $('#loadingSpan').hide();
                    alert("error : " + reponse);
                }
            });
            //alert(para1);
        });
        $("#lkttl").before($(".link")).addClass('active').attr("disabled", "disabled").css('cursor', 'default').css('opacity', 'initial').siblings().removeClass('active').removeAttr('disabled');
        $("#lkttl").click(function (e) { e.preventDefault(); });
        $("#lkttl").siblings().click(function (e) {
            return true;
        });
        $('#identificationNumberSearch').keyup(function ()
        {
            $('#identificationNumberSearch').val(($('#identificationNumberSearch').val()).toUpperCase());
        });
        $('#identificationNumberSearch').focusout(function () {
            var val1 = $('#identificationNumberSearch').val();
            if (val1.length < 6) {
                $(span).text("Please type last 6 characters of VIN/HIN/Serial Number");
            }

        });

        function SetTextBoxValues(tr) {
            $('#identificationNumber').val(tr.find('#vin').text());
            $('#unitYear').val(tr.find('#year').text());
            $('#unitMake').val(tr.find('#make').text());
            $('#unitModel').val(tr.find('#model').text());
            $('#titleStatus').val(tr.find('#currentStatus').text());
        };

        $('#btnUpdate').click(function () {
            var para1 = $('input[name = inlineRadioOptions]:checked').val();
            var unitTitle = {
                "IdentificationNumber": $('#identificationNumber').val(),
                "Year": $('#unitYear').val(),
                "Make": $('#unitMake').val(),
                "Model": $('#unitModel').val(),
                "CurrentTitleStatus": $('#titleStatus').val(),
                "TitleStatus":$('input[name = inlineRadioOptions]:checked').val()
            };

            if ((para1 = 0) || (para1 = 1) || (para1 = 2) || (para1 = 3))
            {
                $.ajax({
                    url: '/UnitTitle/UpdateTitleStatus',
                    data: JSON.stringify(unitTitle),
                    type: 'POST',
                    contentType: 'application/json; charset=utf-8',
                    success: function (View) {
                        if (View != '1') {
                            $(location).attr('href', '/UnitTitle/TitleStatusUpdate?flag=' + View);
                        } else {
                            $(location).attr('href', '/UnitTitle/TitleStatusUpdate?flag=' + View);
                        }
                    }
                });
            }
           
        });
    </script>





</body>
</html>

